<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue-Router 🖖 | one nice blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/jscodev.ico">
    <meta name="description" content="knowledge sharing">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=0">
    
    <link rel="preload" href="/assets/css/0.styles.60d486a0.css" as="style"><link rel="preload" href="/assets/js/app.f47b2c40.js" as="script"><link rel="preload" href="/assets/js/2.af72bc87.js" as="script"><link rel="preload" href="/assets/js/19.c39a071e.js" as="script"><link rel="prefetch" href="/assets/js/10.a9bf79bb.js"><link rel="prefetch" href="/assets/js/11.a427e81e.js"><link rel="prefetch" href="/assets/js/12.0b2b7aa0.js"><link rel="prefetch" href="/assets/js/13.b6b3a056.js"><link rel="prefetch" href="/assets/js/14.64749a17.js"><link rel="prefetch" href="/assets/js/15.da68acb7.js"><link rel="prefetch" href="/assets/js/16.8674dabe.js"><link rel="prefetch" href="/assets/js/17.a549c9d8.js"><link rel="prefetch" href="/assets/js/18.9389fd29.js"><link rel="prefetch" href="/assets/js/20.1dece8a0.js"><link rel="prefetch" href="/assets/js/21.13812f92.js"><link rel="prefetch" href="/assets/js/22.05fd8773.js"><link rel="prefetch" href="/assets/js/23.17941b85.js"><link rel="prefetch" href="/assets/js/24.7023415c.js"><link rel="prefetch" href="/assets/js/25.1f5804ca.js"><link rel="prefetch" href="/assets/js/26.6b4e0d48.js"><link rel="prefetch" href="/assets/js/27.1b788c1d.js"><link rel="prefetch" href="/assets/js/28.af72a96f.js"><link rel="prefetch" href="/assets/js/29.9c6f3345.js"><link rel="prefetch" href="/assets/js/3.fdb7c397.js"><link rel="prefetch" href="/assets/js/4.9c26f943.js"><link rel="prefetch" href="/assets/js/5.d3f16d5a.js"><link rel="prefetch" href="/assets/js/6.231eabe3.js"><link rel="prefetch" href="/assets/js/7.2e35d67b.js"><link rel="prefetch" href="/assets/js/8.25be8698.js"><link rel="prefetch" href="/assets/js/9.1875fa7a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.60d486a0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">one nice blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><span class="title">大前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="大前端" class="mobile-dropdown-title"><span class="title">大前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/full-stack-f/vite/" class="nav-link">
  Vite
</a></li><li class="dropdown-item"><!----> <a href="/full-stack-f/vue-router/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Vue-Router
</a></li><li class="dropdown-item"><!----> <a href="/full-stack-f/flutter/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><h4>
          Javascript
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/full-stack-f/javascript/es/" class="nav-link">
  ECMAScript
</a></li><li class="dropdown-subitem"><a href="/full-stack-f/javascript/js/" class="nav-link">
  JavaScript
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈之巅" class="dropdown-title"><span class="title">全栈之巅</span> <span class="arrow down"></span></button> <button type="button" aria-label="全栈之巅" class="mobile-dropdown-title"><span class="title">全栈之巅</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/full-stack-r/mysql/" class="nav-link">
  Mysql
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机" class="dropdown-title"><span class="title">计算机</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机" class="mobile-dropdown-title"><span class="title">计算机</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/http/" class="nav-link">
  http
</a></li></ul></div></div><div class="nav-item"><a href="https://juejin.im/user/844055260962855" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><span class="title">大前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="大前端" class="mobile-dropdown-title"><span class="title">大前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/full-stack-f/vite/" class="nav-link">
  Vite
</a></li><li class="dropdown-item"><!----> <a href="/full-stack-f/vue-router/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Vue-Router
</a></li><li class="dropdown-item"><!----> <a href="/full-stack-f/flutter/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><h4>
          Javascript
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/full-stack-f/javascript/es/" class="nav-link">
  ECMAScript
</a></li><li class="dropdown-subitem"><a href="/full-stack-f/javascript/js/" class="nav-link">
  JavaScript
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈之巅" class="dropdown-title"><span class="title">全栈之巅</span> <span class="arrow down"></span></button> <button type="button" aria-label="全栈之巅" class="mobile-dropdown-title"><span class="title">全栈之巅</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/full-stack-r/mysql/" class="nav-link">
  Mysql
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机" class="dropdown-title"><span class="title">计算机</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机" class="mobile-dropdown-title"><span class="title">计算机</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/http/" class="nav-link">
  http
</a></li></ul></div></div><div class="nav-item"><a href="https://juejin.im/user/844055260962855" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Vue-Router 🖖</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/full-stack-f/vue-router/#前言" class="sidebar-link">前言</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#前端路由的由来" class="sidebar-link">前端路由的由来</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/full-stack-f/vue-router/#路由的原理" class="sidebar-link">路由的原理</a></li></ul></li><li><a href="/full-stack-f/vue-router/#什么是vue-router" class="sidebar-link">什么是Vue-Router？</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#路由安装" class="sidebar-link">路由安装</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#路由模式" class="sidebar-link">路由模式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#配置路由" class="sidebar-link">配置路由</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#路由插槽" class="sidebar-link">路由插槽</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#vue路由和composition-api" class="sidebar-link">Vue路由和Composition API</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#routerview" class="sidebar-link">RouterView</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#scrollbehavior变化" class="sidebar-link">scrollBehavior变化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#路由重定向与别名" class="sidebar-link">路由重定向与别名</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#动态路由" class="sidebar-link">动态路由</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/vue-router/#结语" class="sidebar-link">结语</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue-router-🖖"><a href="#vue-router-🖖" class="header-anchor">#</a> Vue-Router 🖖</h1> <p><img src="/img/article/vue-router/vue-router-logo.png" alt=""></p> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <p>在编写vue里的SPA（Single Page Application单页面应用）时，我们始终绕不开路由的使用，vue-router4.0版里有一些重要更新，在这里分享给大家。</p> <h2 id="前端路由的由来"><a href="#前端路由的由来" class="header-anchor">#</a> 前端路由的由来</h2> <p>在传统网站里，每次跳转页面都等于重新发一次请求然后浏览器渲染返回的DOM进行展示，在前端的迭代中出现了比较著名的三大框架<code>React</code> 、<code>Vue</code> 、 <code>Angular</code>，他们都是SPA模式的框架，而路由就是解决单页面应用的跳转问题。</p> <h3 id="路由的原理"><a href="#路由的原理" class="header-anchor">#</a> 路由的原理</h3> <p>前端路由 会根据浏览器地址栏<code>pathname</code>的变化，去匹配相应的页面组件。然后将其通过创建<code>DOM</code>节点的形式，插入根节点。这就达到了无刷新页面切换的效果。</p> <p>下面通过两个小例子简单了解一下路由实现原理：</p> <p><strong>hash模式：</strong></p> <p>主要是用过hashchange这一事件去监听地址改变。</p> <ul><li><p>hashchange 当URL的片段标识符更改时，将触发<code>hashchange</code>事件 (跟在＃符号后面的URL部分，包括＃符号)</p></li> <li><p>DOMContentLoaded 当纯HTML被完全加载以及解析时<code>DOMContentLoaded</code>事件会被触发，而不必等待样式表，图片或者子框架完成加载。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> load<span class="token punctuation">)</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'hashchange'</span><span class="token punctuation">,</span> locationHashChanged<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建根元素为入口</span>
  <span class="token keyword">let</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 首次匹配组件</span>
  <span class="token function">locationHashChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">locationHashChanged</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">switch</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token string">'#/a'</span><span class="token operator">:</span>
        root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'a'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token string">'#/b'</span><span class="token operator">:</span>
        root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'b'</span><span class="token punctuation">;</span>
        <span class="token keyword">break</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>

<span class="token punctuation">}</span>


</code></pre></div><p><strong>history模式：</strong></p> <p>history主要依赖HTML5的popstate这一事件去监听地址改变。如果被激活的历史记录条目是通过对history.pushState（）的调用创建的，或者受到对
history.replaceState（）的调用的影响，popstate事件的state属性包含历史条目的状态对象的副本。需要注意的是调用history.pushState()或history.pushState与replaceState()不会触发popstate事件。只有在做出浏览器动作时，才会触发该事件，如用户点击浏览器的回退按钮（或者在Javascript代码中调用history.back()或者history.forward()方法）</p> <p>不同的浏览器在加载页面时处理popstate事件的形式存在差异。页面加载时Chrome和Safari通常会触发(emit)popstate事件，但Firefox则不会。</p> <ul><li><p>popstate 当活动历史记录条目更改时，将触发popstate事件。</p></li> <li><p>history.replaceState 把当前的页面的历史记录替换掉，更新历史栈上最新的入口。</p></li> <li><p>history.pushState 向当前浏览器会话的历史堆栈中添加一个状态</p></li></ul> <p><em>history.pushState和history.replaceState的区别就是是否保留历史状态。</em></p> <p>history.pushState和history.replaceState的参数：</p> <ul><li><p>state 状态对象是一个JavaScript对象。</p></li> <li><p>title 当前大多数浏览器都忽略此参数，尽管将来可能会使用它。</p></li> <li><p>url 新历史记录条目的URL由此参数指定。</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'DOMContentLoaded'</span><span class="token punctuation">,</span> load<span class="token punctuation">)</span>
window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'popstate'</span><span class="token punctuation">,</span> popstateChange<span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">load</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 创建根元素为入口</span>
  <span class="token keyword">let</span> root <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 首次匹配组件</span>
  <span class="token function">popstateChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 获取所有a标签的集合</span>
  <span class="token keyword">var</span> aList <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">'a[href]'</span><span class="token punctuation">)</span>
  <span class="token comment">// 循环添加监听事件</span>
  aList<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token parameter">aNode</span> <span class="token operator">=&gt;</span> aNode<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 阻止默认事件</span>
      e<span class="token punctuation">.</span><span class="token function">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// 获取a标签的href值</span>
      <span class="token keyword">var</span> href <span class="token operator">=</span> aNode<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">)</span>
      <span class="token comment">// 手动修改浏览器的地址栏</span>
      history<span class="token punctuation">.</span><span class="token function">pushState</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">,</span> href<span class="token punctuation">)</span>
      <span class="token comment">// 由于pushState()不能监听地址栏变化不会造成popstate事件调用, 所以此处需要手动执行回调函数</span>
      <span class="token function">popstateChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">popstateChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

  <span class="token keyword">switch</span><span class="token punctuation">(</span>location<span class="token punctuation">.</span>pathname<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'/a'</span><span class="token operator">:</span>
      root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'a'</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
    <span class="token keyword">case</span> <span class="token string">'/b'</span><span class="token operator">:</span>
      root<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token string">'b'</span>
      <span class="token keyword">break</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span>

</code></pre></div><h2 id="什么是vue-router"><a href="#什么是vue-router" class="header-anchor">#</a> 什么是Vue-Router？</h2> <p>Vue路由器是Vue.js的官方路由器，它与Vue.js核心深度集成，使用Vue轻松构建单页应用程序变得轻而易举。功能包括：</p> <ul><li><p>嵌套路线映射</p></li> <li><p>动态路由</p></li> <li><p>模块化，基于组件的路由器配置</p></li> <li><p>路由参数，查询，通配符</p></li> <li><p>查看由Vue.js过渡系统提供动力的过渡效果</p></li> <li><p>细粒度的导航控制</p></li> <li><p>带有自动活动CSS类的链接</p></li> <li><p>HTML5历史记录模式或哈希模式</p></li> <li><p>可自定义的滚动行为</p></li> <li><p>网址的正确编码</p></li></ul> <h2 id="路由安装"><a href="#路由安装" class="header-anchor">#</a> 路由安装</h2> <p><code>npm i vue-router@next</code></p> <h2 id="路由模式"><a href="#路由模式" class="header-anchor">#</a> 路由模式</h2> <ul><li><p><code>createWebHistory</code> 创建history路由模式</p></li> <li><p><code>createWebHashHistory</code> 创建hash路由模式</p></li> <li><p><code>createMemoryHistory</code> 创建基于内存的历史记录</p></li> <li><p>HTML5History类</p></li> <li><p>HashHistory类</p></li> <li><p>AbstractHistory类</p></li></ul> <p><code>HTML5History</code>类和<code>HashHistory</code>类我们都知道，新朋友<code>Abstract</code>模式是用在非浏览器环境的，而非浏览器环境是没有历史记录栈的，所以Abstract内部创造变量<code>stack</code>和<code>index</code>来模拟历史记录栈。</p> <p>这三种路由方式都有一个可选参数base，为每个URL前面的基本路径，默认为'/'</p> <h2 id="配置路由"><a href="#配置路由" class="header-anchor">#</a> 配置路由</h2> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// router/index</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createRouter<span class="token punctuation">,</span> createWebHistory<span class="token punctuation">,</span>  RouteRecordRaw <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue-router'</span>
<span class="token keyword">const</span> <span class="token function-variable function">Login</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/login/login.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">Home</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/home/home.vue'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token function-variable function">About</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> <span class="token keyword">import</span><span class="token punctuation">(</span><span class="token string">'../views/about/about'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> routes<span class="token operator">:</span> Array<span class="token operator">&lt;</span>RouteRecordRaw<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">[</span>  
    <span class="token punctuation">{</span>    path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>    name<span class="token operator">:</span> <span class="token string">'login'</span><span class="token punctuation">,</span>    component<span class="token operator">:</span> Login  <span class="token punctuation">}</span><span class="token punctuation">,</span>  
    <span class="token punctuation">{</span>    path<span class="token operator">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span>    name<span class="token operator">:</span> <span class="token string">'home'</span><span class="token punctuation">,</span>    component<span class="token operator">:</span> Home<span class="token punctuation">,</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span> 
    <span class="token punctuation">{</span>    path<span class="token operator">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span>    name<span class="token operator">:</span> <span class="token string">'about'</span><span class="token punctuation">,</span>    component<span class="token operator">:</span> About  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>  
    history<span class="token operator">:</span> <span class="token function">createWebHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  
    routes
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> router


<span class="token comment">// main</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> createApp <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'vue'</span>
<span class="token keyword">import</span> App <span class="token keyword">from</span> <span class="token string">'./App.vue'</span>
<span class="token keyword">import</span> router <span class="token keyword">from</span> <span class="token string">'./router/index'</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">createApp</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>router<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>

</code></pre></div><p>新版路由器使用<code>createRouter</code>创建，<code>RouteRecordRaw</code>是内置的类型接口，<code>routes</code>改为必传参数</p> <h2 id="路由插槽"><a href="#路由插槽" class="header-anchor">#</a> 路由插槽</h2> <ul><li><p><code>append</code></p></li> <li><p><code>event</code></p></li> <li><p><code>tag</code></p></li> <li><p><code>exact</code></p></li></ul> <p>上面列举的4个属性已经不再使用，改为作用域插槽:</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-link</span> <span class="token attr-name">to</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>/<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ href, navigate, isActive }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ <span class="token punctuation">'</span>active<span class="token punctuation">'</span>: isActive }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>href<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>navigate<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-link</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p>并且你可以手动在全局添加一个<code>append</code>方法：</p> <div class="language-js extra-class"><pre class="language-js"><code>app<span class="token punctuation">.</span>config<span class="token punctuation">.</span>globalProperties<span class="token punctuation">.</span><span class="token function-variable function">append</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">path<span class="token operator">:</span>any<span class="token punctuation">,</span> pathToAppend<span class="token operator">:</span>any</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
path <span class="token operator">+</span> <span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">endsWith</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">''</span> <span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">)</span> <span class="token operator">+</span> pathToAppend

</code></pre></div><p><code>&lt;router-view&gt;</code> <code>&lt;keep-alive&gt;</code> <code>&lt;transition&gt;</code>现在必须通过v-slot API在<code>router-view</code>内部使用<code>transition</code>和<code>keep-alive</code>。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>router-view</span> <span class="token attr-name">v-slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{ Component }<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>transition</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>component</span> <span class="token attr-name">:is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Component<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>keep-alive</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>transition</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>router-view</span><span class="token punctuation">&gt;</span></span>

</code></pre></div><p>现有的<code>router.onReady</code>函数已替换为<code>router.isReady</code>，该函数不接受任何参数并返回<code>Promise</code></p> <p>因为现在导航包含第一个都是异步的，所以如果使用<code>transition</code>，需要在挂载<code>dom</code>之前调用<code>isReady</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code>router<span class="token punctuation">.</span><span class="token function">isReady</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> app<span class="token punctuation">.</span><span class="token function">mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="vue路由和composition-api"><a href="#vue路由和composition-api" class="header-anchor">#</a> Vue路由和Composition API</h2> <p>当我们使用<code>router-link</code>标签时是一点毛病也没有，但是当需要编程式路由跳转的时候沙雕了，没有<code>this</code>咋调用<code>router</code>啊！难道还要再写一个<code>methods</code>在里面操作吗（黑人问号），还好这里咱们的<code>router</code>给了解决办法，看下图：</p> <p><img src="/img/article/vue-router/vue-router-a.png" alt=""></p> <p>这里只需要调用对应的<code>userRouter</code>函数就可以了，注意要在上方<code>import</code>引入，在<code>setup</code>里面不用<code>return</code>返回。（这里没有贴代码，自己手动敲一下感受编程的快乐🤣）</p> <h2 id="routerview"><a href="#routerview" class="header-anchor">#</a> RouterView</h2> <p>在一种情景下，我们可能会需要在页面中同时显示多个路由视图，而不是嵌套，那么就需要用到<code>router-view</code>的<code>name</code>属性，默认使用<code>default</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 页面</span>

<span class="token operator">&lt;</span>router<span class="token operator">-</span>view<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>router<span class="token operator">-</span>view name<span class="token operator">=</span><span class="token string">&quot;about&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>router<span class="token operator">-</span>view name<span class="token operator">=</span><span class="token string">&quot;login&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>router<span class="token operator">-</span>view<span class="token operator">&gt;</span>

<span class="token comment">// router/index</span>

<span class="token keyword">const</span> router <span class="token operator">=</span> <span class="token function">createRouter</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  history<span class="token operator">:</span> <span class="token function">createWebHashHistory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  routes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span>
      components<span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token keyword">default</span><span class="token operator">:</span> Home<span class="token punctuation">,</span>
        <span class="token comment">// 这里是es6对象增强写法</span>
        login<span class="token punctuation">,</span>
        <span class="token comment">// 同理</span>
        about<span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><p><code>components</code>里面的组件会与<code>router-view</code>里面的<code>name</code>相对应。</p> <h2 id="scrollbehavior变化"><a href="#scrollbehavior变化" class="header-anchor">#</a> scrollBehavior变化</h2> <p><code>scrollBehavior</code>返回的对象x重命名为<code>left</code>，<code>y</code>重命名为<code>top</code>。</p> <h2 id="路由重定向与别名"><a href="#路由重定向与别名" class="header-anchor">#</a> 路由重定向与别名</h2> <p>路由重定向(redirect)就是通过各种方法将各种网络请求重新定个方向转到其它位置，如<code>/home</code>转到<code>/</code></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 路径写法</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> redirect<span class="token operator">:</span> <span class="token string">'/'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token comment">// 命名写法</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/home'</span><span class="token punctuation">,</span> redirect<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'homepage'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token comment">// 函数写法</span>
<span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    path<span class="token operator">:</span> <span class="token string">'/search/:searchText'</span><span class="token punctuation">,</span>
    <span class="token function-variable function">redirect</span><span class="token operator">:</span> <span class="token parameter">to</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/search'</span><span class="token punctuation">,</span> query<span class="token operator">:</span> <span class="token punctuation">{</span> q<span class="token operator">:</span> to<span class="token punctuation">.</span>params<span class="token punctuation">.</span>searchText <span class="token punctuation">}</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span>
</code></pre></div><p>别名表示访问<code>url</code>时自由命名，不受约束，<code>router</code>会自动进行别名匹配，就像我们设置<code>/</code>的别名为<code>/home</code>，相当于访问<code>/</code>：</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> routes <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'/'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> Homepage<span class="token punctuation">,</span> alias<span class="token operator">:</span> <span class="token string">'/home'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span>

<span class="token comment">// alias是别名的key</span>
</code></pre></div><h2 id="动态路由"><a href="#动态路由" class="header-anchor">#</a> 动态路由</h2> <p>在一些特定场景里面我们可能会使用到动态路由，所以这里给出了使用方式，动态路由主要通过两个功能实现<code>router.addRoute()</code>和<code>router.removeRoute()</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// addRoute是添加一条新的路由路径</span>

router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'about'</span><span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> About <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// removeRoute是删除路由，注意删除后对应的子路由和别名都会删掉</span>

router<span class="token punctuation">.</span><span class="token function">removeRoute</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">)</span>

<span class="token comment">// 路由嵌套</span>

router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'profile'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> Profile<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//等价于</span>

router<span class="token punctuation">.</span><span class="token function">addRoute</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">'about'</span><span class="token punctuation">,</span>
  path<span class="token operator">:</span> <span class="token string">'/about'</span><span class="token punctuation">,</span>
  component<span class="token operator">:</span> About<span class="token punctuation">,</span>
  children<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> path<span class="token operator">:</span> <span class="token string">'profile'</span><span class="token punctuation">,</span> component<span class="token operator">:</span> Profile<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="结语"><a href="#结语" class="header-anchor">#</a> 结语</h2> <p>个人感觉router-link和router-view修改成插槽模式之后写法虽然麻烦了一些但是却更加灵活，我们可以在里面实现自己的很多黑魔法（呸，是妙码生花🤥），这样同一种功能就会有很多种实现方式，不过在项目中还是要注意统一一下代码规范性，希望看完这篇文章对大家有帮助。</p> <Code></Code></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f47b2c40.js" defer></script><script src="/assets/js/2.af72bc87.js" defer></script><script src="/assets/js/19.c39a071e.js" defer></script>
  </body>
</html>
