<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Flutter | one nice blog</title>
    <meta name="generator" content="VuePress 1.7.1">
    <link rel="icon" href="/jscodev.ico">
    <meta name="description" content="knowledge sharing">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0,user-scalable=0">
    
    <link rel="preload" href="/assets/css/0.styles.60d486a0.css" as="style"><link rel="preload" href="/assets/js/app.f47b2c40.js" as="script"><link rel="preload" href="/assets/js/2.af72bc87.js" as="script"><link rel="preload" href="/assets/js/14.64749a17.js" as="script"><link rel="preload" href="/assets/js/7.2e35d67b.js" as="script"><link rel="prefetch" href="/assets/js/10.a9bf79bb.js"><link rel="prefetch" href="/assets/js/11.a427e81e.js"><link rel="prefetch" href="/assets/js/12.0b2b7aa0.js"><link rel="prefetch" href="/assets/js/13.b6b3a056.js"><link rel="prefetch" href="/assets/js/15.da68acb7.js"><link rel="prefetch" href="/assets/js/16.8674dabe.js"><link rel="prefetch" href="/assets/js/17.a549c9d8.js"><link rel="prefetch" href="/assets/js/18.9389fd29.js"><link rel="prefetch" href="/assets/js/19.c39a071e.js"><link rel="prefetch" href="/assets/js/20.1dece8a0.js"><link rel="prefetch" href="/assets/js/21.13812f92.js"><link rel="prefetch" href="/assets/js/22.05fd8773.js"><link rel="prefetch" href="/assets/js/23.17941b85.js"><link rel="prefetch" href="/assets/js/24.7023415c.js"><link rel="prefetch" href="/assets/js/25.1f5804ca.js"><link rel="prefetch" href="/assets/js/26.6b4e0d48.js"><link rel="prefetch" href="/assets/js/27.1b788c1d.js"><link rel="prefetch" href="/assets/js/28.af72a96f.js"><link rel="prefetch" href="/assets/js/29.9c6f3345.js"><link rel="prefetch" href="/assets/js/3.fdb7c397.js"><link rel="prefetch" href="/assets/js/4.9c26f943.js"><link rel="prefetch" href="/assets/js/5.d3f16d5a.js"><link rel="prefetch" href="/assets/js/6.231eabe3.js"><link rel="prefetch" href="/assets/js/8.25be8698.js"><link rel="prefetch" href="/assets/js/9.1875fa7a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.60d486a0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">one nice blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/home/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><span class="title">大前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="大前端" class="mobile-dropdown-title"><span class="title">大前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/full-stack-f/vite/" class="nav-link">
  Vite
</a></li><li class="dropdown-item"><!----> <a href="/full-stack-f/vue-router/" class="nav-link">
  Vue-Router
</a></li><li class="dropdown-item"><!----> <a href="/full-stack-f/flutter/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Flutter
</a></li><li class="dropdown-item"><h4>
          Javascript
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/full-stack-f/javascript/es/" class="nav-link">
  ECMAScript
</a></li><li class="dropdown-subitem"><a href="/full-stack-f/javascript/js/" class="nav-link">
  JavaScript
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈之巅" class="dropdown-title"><span class="title">全栈之巅</span> <span class="arrow down"></span></button> <button type="button" aria-label="全栈之巅" class="mobile-dropdown-title"><span class="title">全栈之巅</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/full-stack-r/mysql/" class="nav-link">
  Mysql
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机" class="dropdown-title"><span class="title">计算机</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机" class="mobile-dropdown-title"><span class="title">计算机</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/http/" class="nav-link">
  http
</a></li></ul></div></div><div class="nav-item"><a href="https://juejin.im/user/844055260962855" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/home/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="大前端" class="dropdown-title"><span class="title">大前端</span> <span class="arrow down"></span></button> <button type="button" aria-label="大前端" class="mobile-dropdown-title"><span class="title">大前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/full-stack-f/vite/" class="nav-link">
  Vite
</a></li><li class="dropdown-item"><!----> <a href="/full-stack-f/vue-router/" class="nav-link">
  Vue-Router
</a></li><li class="dropdown-item"><!----> <a href="/full-stack-f/flutter/" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  Flutter
</a></li><li class="dropdown-item"><h4>
          Javascript
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/full-stack-f/javascript/es/" class="nav-link">
  ECMAScript
</a></li><li class="dropdown-subitem"><a href="/full-stack-f/javascript/js/" class="nav-link">
  JavaScript
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="全栈之巅" class="dropdown-title"><span class="title">全栈之巅</span> <span class="arrow down"></span></button> <button type="button" aria-label="全栈之巅" class="mobile-dropdown-title"><span class="title">全栈之巅</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/full-stack-r/mysql/" class="nav-link">
  Mysql
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机" class="dropdown-title"><span class="title">计算机</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机" class="mobile-dropdown-title"><span class="title">计算机</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/http/" class="nav-link">
  http
</a></li></ul></div></div><div class="nav-item"><a href="https://juejin.im/user/844055260962855" target="_blank" rel="noopener noreferrer" class="nav-link external">
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Flutter</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/full-stack-f/flutter/#安装" class="sidebar-link">安装</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#flutter生命周期" class="sidebar-link">Flutter生命周期</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/full-stack-f/flutter/#initstate的使用" class="sidebar-link">initState的使用</a></li></ul></li><li><a href="/full-stack-f/flutter/#按钮button" class="sidebar-link">按钮Button</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#flutter中的key的作用" class="sidebar-link">flutter中的key的作用</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#const" class="sidebar-link">const</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#配置底部导航栏" class="sidebar-link">配置底部导航栏</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#在flutter里面使用本地图片" class="sidebar-link">在flutter里面使用本地图片</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#在flutter中设置全局样式" class="sidebar-link">在flutter中设置全局样式</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#ongenerateroute" class="sidebar-link">onGenerateRoute</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#路由跳转" class="sidebar-link">路由跳转</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#事件监听" class="sidebar-link">事件监听</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#flutter之动画" class="sidebar-link">flutter之动画</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/full-stack-f/flutter/#全自动动画-animation" class="sidebar-link">全自动动画 (Animation)</a></li><li class="sidebar-sub-header"><a href="/full-stack-f/flutter/#手动控制-transform" class="sidebar-link">手动控制 (Transform)</a></li><li class="sidebar-sub-header"><a href="/full-stack-f/flutter/#自定义动画animatedbuilder" class="sidebar-link">自定义动画AnimatedBuilder</a></li><li class="sidebar-sub-header"><a href="/full-stack-f/flutter/#嵌入式插件动画rive-flare" class="sidebar-link">嵌入式插件动画Rive/Flare</a></li></ul></li><li><a href="/full-stack-f/flutter/#setstate不好使" class="sidebar-link">setState不好使</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#flutter中让盒子铺满屏幕" class="sidebar-link">flutter中让盒子铺满屏幕</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#listview" class="sidebar-link">ListView</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#gridview" class="sidebar-link">GridView</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#stream" class="sidebar-link">Stream</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/full-stack-f/flutter/#flutter队列" class="sidebar-link">flutter队列</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="flutter"><a href="#flutter" class="header-anchor">#</a> Flutter</h1> <h2 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h2> <p><a href="https://flutterchina.club/setup-windows/" target="_blank" rel="noopener noreferrer">按照官方步骤安装即可<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><em>PS:复制flutter的下载链接放到迅雷里会快点。</em></p> <p><a href="https://pub.dev/" target="_blank" rel="noopener noreferrer">插件地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>使用Android Studio创建项目后去掉编辑框的竖线，修改如下图配置</strong></p> <p><img src="/img/flutter/flutter/android-line.jpg" alt=""></p> <p><strong>使用Vscode创建项目后去掉编辑框的竖线，修改如下图配置</strong></p> <p><img src="/img/flutter/flutter/vscode-line.jpg" alt=""></p> <p>在这settings.json里面找到<code>editor.rulers</code>属性然后删掉或注释。</p> <p>运行<code>flutter run</code>后，可以使用以下按键快速调试：</p> <ul><li>r键：点击后热更新</li> <li>R键：热重载</li> <li>h键：显示帮助信息</li> <li>P键： 显示网格</li> <li>O键： 切换android和ios的预览模式</li> <li>Q键： 退出调试预览模式</li></ul> <p><em>PS：这里列举几个常用的，了解更多可以运行项目后按h键查看</em></p> <p>使用vscode连不上第三方模拟器解决方案：</p> <p><strong>MuMu模拟器</strong></p> <p>cd到第三方模拟器的bin目录下运行<code>adb_server.exe connect 127.0.0.1:7555</code></p> <p><strong>夜神模拟器</strong></p> <p>cd到第三方模拟器的bin目录下运行<code>nox_adb.exe connect 127.0.0.1:62001</code></p> <p><strong>flutter-初次运行卡在Running Gradle task assembleDebug</strong></p> <p>这是是因为下载响应慢的问题，这时候我们需要配置一下镜像地址：</p> <p><strong>记得在这之前运行<code>flutter doctor</code>确保你确认了android许可证</strong></p> <p>解决方案一：</p> <p>1、 修改 Flutter 项目中 /android/build.gradle 文件，修改2处：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
buildscript <span class="token punctuation">{</span>
    ext<span class="token punctuation">.</span>kotlin_version <span class="token operator">=</span> <span class="token string">'1.3.50'</span>
    repositories <span class="token punctuation">{</span>
        <span class="token comment">// 第一处需要修改的地方</span>
<span class="token comment">//        google()</span>
<span class="token comment">//        jcenter()</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'https://maven.aliyun.com/repository/google'</span> <span class="token punctuation">}</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'https://maven.aliyun.com/repository/jcenter'</span> <span class="token punctuation">}</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'http://maven.aliyun.com/nexus/content/groups/public'</span> <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    dependencies <span class="token punctuation">{</span>
        classpath <span class="token string">'com.android.tools.build:gradle:3.5.0'</span>
        classpath <span class="token string">&quot;org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

allprojects <span class="token punctuation">{</span>
    repositories <span class="token punctuation">{</span>
        <span class="token comment">// 第二处需要修改的地方</span>
<span class="token comment">//        google()</span>
<span class="token comment">//        jcenter()</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'https://maven.aliyun.com/repository/google'</span> <span class="token punctuation">}</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'https://maven.aliyun.com/repository/jcenter'</span> <span class="token punctuation">}</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'http://maven.aliyun.com/nexus/content/groups/public'</span> <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

rootProject<span class="token punctuation">.</span>buildDir <span class="token operator">=</span> <span class="token string">'../build'</span>
subprojects <span class="token punctuation">{</span>
    project<span class="token punctuation">.</span>buildDir <span class="token operator">=</span> <span class="token string">&quot;${rootProject.buildDir}/${project.name}&quot;</span>
<span class="token punctuation">}</span>
subprojects <span class="token punctuation">{</span>
    project<span class="token punctuation">.</span><span class="token function">evaluationDependsOn</span><span class="token punctuation">(</span><span class="token string">':app'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

task <span class="token function">clean</span><span class="token punctuation">(</span>type<span class="token punctuation">:</span> Delete<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    delete rootProject<span class="token punctuation">.</span>buildDir
<span class="token punctuation">}</span>



</code></pre></div><p>2、修改 flutter SDK 文件夹的 flutter安装目录/packages/flutter_tools/gradle/flutter.gradle 文件，修改1处：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
buildscript <span class="token punctuation">{</span>
    repositories <span class="token punctuation">{</span>
       <span class="token comment">// 需要修改的地方</span>
       <span class="token comment">// google()</span>
       <span class="token comment">// jcenter()</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'https://maven.aliyun.com/repository/google'</span> <span class="token punctuation">}</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'https://maven.aliyun.com/repository/jcenter'</span> <span class="token punctuation">}</span>
        maven <span class="token punctuation">{</span> url <span class="token string">'http://maven.aliyun.com/nexus/content/groups/public'</span> <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>
    dependencies <span class="token punctuation">{</span>
        classpath <span class="token string">'com.android.tools.build:gradle:3.5.0'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>解决方案二：</p> <p>1、修改 flutter安装目录/packages/flutter_tools/gradle/resolve_dependencies.gradle 文件</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
repositories <span class="token punctuation">{</span>
    <span class="token function">google</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">jcenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    maven <span class="token punctuation">{</span>
        <span class="token comment">//url &quot;$storageUrl/download.flutter.io&quot;</span>
        url <span class="token string">&quot;http://download.flutter.io&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>2、修改 flutter/packages/flutter_tools/gradle/flutter.gradle 文件</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token comment">// private static final String DEFAULT_MAVEN_HOST = &quot;https://storage.googleapis.com&quot;;</span>
private <span class="token keyword">static</span> <span class="token keyword">final</span> String DEFAULT_MAVEN_HOST <span class="token operator">=</span> <span class="token string">&quot;https://storage.flutter-io.cn/download.flutter.io&quot;</span><span class="token punctuation">;</span>

</code></pre></div><p>解决方案三：</p> <p>可以在官网 https://gradle.org/releases/ 页面下载对应的 “complete” 安装包
下载后，修改flutter项目 /android/gradle/wrapper/gradle-wrapper.properties 文件：</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token comment">//这里修改映射到你本地gradle文件路径</span>
#distributionUrl<span class="token operator">=</span>https\<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>services<span class="token punctuation">.</span>gradle<span class="token punctuation">.</span>org<span class="token operator">/</span>distributions<span class="token operator">/</span>gradle<span class="token operator">-</span><span class="token number">5.6</span><span class="token number">.2</span><span class="token operator">-</span>all<span class="token punctuation">.</span>zip
distributionUrl<span class="token operator">=</span>file<span class="token operator">:</span><span class="token operator">/</span><span class="token comment">//E:/Android/Gradle/gradle-5.6-all.zip</span>

好了，到这里就可以看到项目跑起来了，接下来就是开发时间了。

</code></pre></div><p>在Flutter中，万物皆Widget，我们通过构造函数嵌套Widget来编写UI界面；实际上，Widget并不是真正要显示在屏幕上的东西，只是一个配置信息，它永远是immutable的。</p> <p>Flutter三棵树：</p> <ul><li>Widget Tree</li> <li>Element Tree</li> <li>Render Tree</li></ul> <h2 id="flutter生命周期"><a href="#flutter生命周期" class="header-anchor">#</a> Flutter生命周期</h2> <ul><li><p>createState 该函数为StatefulWidget中创建State的方法，当StatefulWidget被调用时会立即执行createState。</p></li> <li><p>initState 该函数为State初始化调用，因此可以在此期间执行 State 各变量的初始赋值，同时也可以在此期间与服务端交互，获取服务端数据后调用setState来设置State。</p></li> <li><p>didChangeDependencies 该函数是在该组件依赖的State发生变化时，这里说的State为全局State。</p></li> <li><p>build 主要是返回需要渲染的Widget，由于build会被调用多次，因此在该函数中只能做返回Widget相关逻辑，避免因为执行多次导致状态异常。</p></li> <li><p>reassemble 主要是提供开发阶段使用，在debug模式下，每次热重载都会调用该函数，因此在debug阶段可以在此期间增加一些debug代码，来检查代码问题。</p></li> <li><p>didUpdateWidget 该函数主要是在组件重新构建，比如说热重载，父组件发生build的情况下，子组件该方法才会被调用，其次该方法调用之后一定会再调用本组件中的build方法。</p></li> <li><p>deactivate 在组件被移除节点后会被调用，如果该组件被移除节点，然后未被插入到其他节点时，则会继续调用dispose永久移除。</p></li> <li><p>dispose 永久移除组件，并释放组件资源。</p></li></ul> <h3 id="initstate的使用"><a href="#initstate的使用" class="header-anchor">#</a> initState的使用</h3> <div class="language- extra-class"><pre><code>initState()是有状态窗口小部件插入到窗口小部件树中时被调用一次的方法，可以把它当成动态部件的生命周期。

如果需要进行某种初始化工作（例如注册侦听器），则通常会覆盖此方法，因为与build()调用此方法不同。

并且要注销您的侦听器（或进行一些后期工作），请重写dispose()method。

State的子类可以重写initState来完成只需要发生一次的工作。例如，重写initState可配置动画或订阅平台服务。需要通过调用super.initState来启动initState的实现。

当不再需要状态对象时，框架会在状态对象上调用dispose（）。覆盖处理功能以执行清理工作。例如，覆盖处置可取消计时器或取消订阅平台服务。Dispose的实现通常以调用super.dispose结尾
</code></pre></div><p>比如当我们需要做动画的时候可以使用这个方法：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token comment">// 初始化</span>

AnimationController controller<span class="token punctuation">;</span>
Animation<span class="token operator">&lt;</span>double<span class="token operator">&gt;</span> animation<span class="token punctuation">;</span>

<span class="token metadata symbol">@override</span>
<span class="token keyword">void</span> <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// CurvedAnimation</span>
    <span class="token comment">// 创建 AnimationController 对象</span>
    controller <span class="token operator">=</span> <span class="token function">AnimationController</span><span class="token punctuation">(</span>
        vsync<span class="token punctuation">:</span> <span class="token keyword">this</span><span class="token punctuation">,</span> duration<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token function">Duration</span><span class="token punctuation">(</span>milliseconds<span class="token punctuation">:</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 通过 Tween 对象 创建 Animation 对象</span>
    animation <span class="token operator">=</span> <span class="token function">Tween</span><span class="token punctuation">(</span>begin<span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">,</span> end<span class="token punctuation">:</span> <span class="token number">200.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>controller<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 注意：这句不能少，否则 widget 不会重绘，也就看不到动画效果</span>
        <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 执行动画</span>
    controller<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 释放资源</span>

<span class="token metadata symbol">@override</span>
<span class="token keyword">void</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    controller<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre></div><p><strong>在使用initState函数的时候也会遇到一些问题，比如在里面做页面跳转或加载widget的时候，这时候我们可以用延迟跳转来避免这个问题：</strong></p> <div class="language-dart extra-class"><pre class="language-dart"><code>
Future<span class="token punctuation">.</span><span class="token function">delayed</span><span class="token punctuation">(</span>Duration<span class="token punctuation">.</span>zero<span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token function">showWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><h2 id="按钮button"><a href="#按钮button" class="header-anchor">#</a> 按钮Button</h2> <p>这里列举几个常见的按钮：</p> <ul><li><p>RaisedButton ：凸起的按钮，继承自MaterialButton</p></li> <li><p>FlatButton ：扁平化的按钮，继承自MaterialButton</p></li> <li><p>OutlinedButton ：带边框的按钮，继承自MaterialButton</p></li> <li><p>IconButton ：图标按钮,继承自StatelessWidget</p></li></ul> <p><strong>按钮常用属性</strong></p> <ul><li><p>onPressed: 一般接收一个方法	必填参数，按下按钮时触发的回调，接收一个方法，传null表示按钮禁用，会显示禁用相关样式</p></li> <li><p>child: 文本控件</p></li> <li><p>textColor: 文本颜色</p></li> <li><p>color: 按钮的颜色</p></li> <li><p>disabledColor: 按钮禁用时的颜色</p></li> <li><p>disabledTextColor: 按钮禁用时的文本颜色</p></li> <li><p>splashColor: 点击按钮时水波纹的颜色</p></li> <li><p>highlightColor: 点击（长按）按钮后按钮的颜色</p></li> <li><p>elevation: 阴影的范围，值越大阴影范围越大</p></li> <li><p>padding: 内边距</p></li> <li><p>shape: 设置按钮的形状</p></li> <li><p>minWidth: 最小宽度</p></li> <li><p>height: 高度</p></li></ul> <h2 id="flutter中的key的作用"><a href="#flutter中的key的作用" class="header-anchor">#</a> flutter中的key的作用</h2> <p>在开发flutter项目的过程中我们经常会看到下面的这句代：</p> <div class="language-js extra-class"><pre class="language-js"><code>
<span class="token keyword">const</span> <span class="token function">MyApp</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>name<span class="token punctuation">,</span> <span class="token punctuation">{</span> Key key <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">super</span><span class="token punctuation">(</span>key <span class="token operator">:</span> key<span class="token punctuation">)</span> 

</code></pre></div><p>这里面的key其实就是为了保证元素的唯一，使用key让flutter知道你修改的Widget以达到预期的效果，的因为在flutter渲染页面的时候，如果你不给元素指定key值那么它认为你没有做修改从而不创建新的元素保证了性能，所以在一些情境下我们需要给小部件加一个key的值保证达到想要的效果。</p> <p>flutter中的key有两种LocalKey和GlobalKey，而LocalKey又分三个子类：</p> <ul><li><p>LocalKey</p> <ul><li><p>ValueKey</p></li> <li><p>UniqueKey</p></li> <li><p>ObjectKey</p></li></ul></li> <li><p>GlobalKey</p></li></ul> <h2 id="const"><a href="#const" class="header-anchor">#</a> const</h2> <p>在配置一些属性时，我们可以对常量用const修饰一下，这样可以触发flutter的优化：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token function">Container</span><span class="token punctuation">(</span>
    margin<span class="token punctuation">:</span> <span class="token keyword">const</span> EdgeInsets<span class="token punctuation">.</span><span class="token function">only</span><span class="token punctuation">(</span>left<span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">,</span>

</code></pre></div><h2 id="配置底部导航栏"><a href="#配置底部导航栏" class="header-anchor">#</a> 配置底部导航栏</h2> <p>flutter配置底部导航栏需要在<code>MaterialApp</code>里面添加<code>BottomNavigationBar</code>属性，<code>BottomNavigationBar</code>的常见属性下面列举：</p> <ul><li><p>items 底部按钮组合，类型<code>List&lt;BottomNavigationBarItem&gt;</code></p></li> <li><p>iconSize 图标</p></li> <li><p>currentIndex 导航索引</p></li> <li><p>onTap 选中的回调函数</p></li> <li><p>fixedColor 选中的颜色</p></li> <li><p>type <code>BottomNavigationBarType.fixed | BottomNavigationBarType.shifting</code>两个属性来控制tab的显示方式，一般情况下用fixed自动适配就可以，具体效果可以自行尝试</p></li></ul> <h2 id="在flutter里面使用本地图片"><a href="#在flutter里面使用本地图片" class="header-anchor">#</a> 在flutter里面使用本地图片</h2> <p>首先在lib同级目录下创建一个文件夹名字随便起（建议assets），然后创建2.0x、3.0x的文件夹把对应图片放入，一般项目中用2.0x和3.0x就可以，接下来在<code>pubspec.yaml</code>文件里面配置一下路径，路径不用加2.0x或3.0x</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
flutter<span class="token punctuation">:</span>
  assets<span class="token punctuation">:</span>
    <span class="token operator">-</span> assets<span class="token operator">/</span>images<span class="token operator">/</span>home<span class="token operator">/</span>

<span class="token comment">// 记得这里home下也要放相同的图片，不然会找不到，默认找的不是2.0x和3.0x下面的图片。</span>

</code></pre></div><h2 id="在flutter中设置全局样式"><a href="#在flutter中设置全局样式" class="header-anchor">#</a> 在flutter中设置全局样式</h2> <p>有时候我们想在flutter中把文字统一一个颜色或者大小等样式，在写web的时候创建一个公共css文件引入就可以，在flutter里面没有css所以我们需要在入口mian.dart里面设置MaterialApp的theme属性，这里是配置flutter主题配置，如果不配置就会使用默认样式。</p> <p>theme接收一个ThemeData小部件，ThemeData可以传的参数如下：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token function">ThemeData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  Brightness brightness<span class="token punctuation">,</span> <span class="token comment">// 应用整体主题的亮度。用于按钮之类的小部件，以确定在不使用主色或强调色时选择什么颜色。</span>
  MaterialColor primarySwatch<span class="token punctuation">,</span><span class="token comment">// 定义一个单一的颜色以及十个色度的色块。</span>
  Color primaryColor<span class="token punctuation">,</span> <span class="token comment">// 应用程序主要部分的背景颜色(toolbars、tab bars 等)</span>
  Brightness primaryColorBrightness<span class="token punctuation">,</span> <span class="token comment">// primaryColor的亮度。用于确定文本的颜色和放置在主颜色之上的图标(例如工具栏文本)。</span>
  Color primaryColorLight<span class="token punctuation">,</span> <span class="token comment">// primaryColor的浅色版</span>
  Color primaryColorDark<span class="token punctuation">,</span> <span class="token comment">// primaryColor的深色版</span>
  Color accentColor<span class="token punctuation">,</span> <span class="token comment">// 小部件的前景色(旋钮、文本、覆盖边缘效果等)。</span>
  Brightness accentColorBrightness<span class="token punctuation">,</span> <span class="token comment">// accentColor的亮度。</span>
  Color canvasColor<span class="token punctuation">,</span> <span class="token comment">//  MaterialType.canvas 的默认颜色</span>
  Color scaffoldBackgroundColor<span class="token punctuation">,</span> <span class="token comment">// Scaffold的默认颜色。典型Material应用程序或应用程序内页面的背景颜色。</span>
  Color bottomAppBarColor<span class="token punctuation">,</span> <span class="token comment">// BottomAppBar的默认颜色</span>
  Color cardColor<span class="token punctuation">,</span> <span class="token comment">// Card的颜色</span>
  Color dividerColor<span class="token punctuation">,</span> <span class="token comment">// Divider和PopupMenuDivider的颜色，也用于ListTile之间、DataTable的行之间等。</span>
  Color highlightColor<span class="token punctuation">,</span> <span class="token comment">// 选中在泼墨动画期间使用的突出显示颜色，或用于指示菜单中的项。</span>
  Color splashColor<span class="token punctuation">,</span>  <span class="token comment">// 墨水飞溅的颜色。InkWell</span>
  InteractiveInkFeatureFactory splashFactory<span class="token punctuation">,</span> <span class="token comment">// 定义由InkWell和InkResponse反应产生的墨溅的外观。</span>
  Color selectedRowColor<span class="token punctuation">,</span> <span class="token comment">// 用于突出显示选定行的颜色。</span>
  Color unselectedWidgetColor<span class="token punctuation">,</span> <span class="token comment">// 用于处于非活动(但已启用)状态的小部件的颜色。例如，未选中的复选框。通常与accentColor形成对比。也看到disabledColor。</span>
  Color disabledColor<span class="token punctuation">,</span> <span class="token comment">// 禁用状态下部件的颜色，无论其当前状态如何。例如，一个禁用的复选框(可以选中或未选中)。</span>
  Color buttonColor<span class="token punctuation">,</span> <span class="token comment">// RaisedButton按钮中使用的Material 的默认填充颜色。</span>
  ButtonThemeData buttonTheme<span class="token punctuation">,</span> <span class="token comment">// 定义按钮部件的默认配置，如RaisedButton和FlatButton。</span>
  Color secondaryHeaderColor<span class="token punctuation">,</span> <span class="token comment">// 选定行时PaginatedDataTable标题的颜色。</span>
  Color textSelectionColor<span class="token punctuation">,</span> <span class="token comment">// 文本框中文本选择的颜色，如TextField</span>
  Color cursorColor<span class="token punctuation">,</span> <span class="token comment">// 文本框中光标的颜色，如TextField</span>
  Color textSelectionHandleColor<span class="token punctuation">,</span>  <span class="token comment">// 用于调整当前选定的文本部分的句柄的颜色。</span>
  Color backgroundColor<span class="token punctuation">,</span> <span class="token comment">// 与主色形成对比的颜色，例如用作进度条的剩余部分。</span>
  Color dialogBackgroundColor<span class="token punctuation">,</span> <span class="token comment">// Dialog 元素的背景颜色</span>
  Color indicatorColor<span class="token punctuation">,</span> <span class="token comment">// 选项卡中选定的选项卡指示器的颜色。</span>
  Color hintColor<span class="token punctuation">,</span> <span class="token comment">// 用于提示文本或占位符文本的颜色，例如在TextField中。</span>
  Color errorColor<span class="token punctuation">,</span> <span class="token comment">// 用于输入验证错误的颜色，例如在TextField中</span>
  Color toggleableActiveColor<span class="token punctuation">,</span> <span class="token comment">// 用于突出显示Switch、Radio和Checkbox等可切换小部件的活动状态的颜色。</span>
  String fontFamily<span class="token punctuation">,</span> <span class="token comment">// 文本字体</span>
  TextTheme textTheme<span class="token punctuation">,</span> <span class="token comment">// 带有与卡片和画布颜色形成对比的颜色的文本。</span>
  TextTheme primaryTextTheme<span class="token punctuation">,</span> <span class="token comment">// 与primaryColor形成对比的文本主题</span>
  TextTheme accentTextTheme<span class="token punctuation">,</span> <span class="token comment">// 与accentColor形成对比的文本主题。</span>
  InputDecorationTheme inputDecorationTheme<span class="token punctuation">,</span> <span class="token comment">// 基于这个主题的 InputDecorator、TextField和TextFormField的默认InputDecoration值。</span>
  IconThemeData iconTheme<span class="token punctuation">,</span> <span class="token comment">// 与卡片和画布颜色形成对比的图标主题</span>
  IconThemeData primaryIconTheme<span class="token punctuation">,</span> <span class="token comment">// 与primaryColor形成对比的图标主题</span>
  IconThemeData accentIconTheme<span class="token punctuation">,</span> <span class="token comment">// 与accentColor形成对比的图标主题。</span>
  SliderThemeData sliderTheme<span class="token punctuation">,</span>  <span class="token comment">// 用于呈现Slider的颜色和形状</span>
  TabBarTheme tabBarTheme<span class="token punctuation">,</span> <span class="token comment">// 用于自定义选项卡栏指示器的大小、形状和颜色的主题。</span>
  CardTheme cardTheme<span class="token punctuation">,</span> <span class="token comment">// Card的颜色和样式</span>
  ChipThemeData chipTheme<span class="token punctuation">,</span> <span class="token comment">// Chip的颜色和样式</span>
  TargetPlatform platform<span class="token punctuation">,</span> 
  MaterialTapTargetSize materialTapTargetSize<span class="token punctuation">,</span> <span class="token comment">// 配置某些Material部件的命中测试大小</span>
  PageTransitionsTheme pageTransitionsTheme<span class="token punctuation">,</span> 
  AppBarTheme appBarTheme<span class="token punctuation">,</span> <span class="token comment">// 用于自定义Appbar的颜色、高度、亮度、iconTheme和textTheme的主题。</span>
  BottomAppBarTheme bottomAppBarTheme<span class="token punctuation">,</span> <span class="token comment">// 自定义BottomAppBar的形状、高度和颜色的主题。</span>
  ColorScheme colorScheme<span class="token punctuation">,</span> <span class="token comment">// 拥有13种颜色，可用于配置大多数组件的颜色。</span>
  DialogTheme dialogTheme<span class="token punctuation">,</span> <span class="token comment">// 自定义Dialog的主题形状</span>
  Typography typography<span class="token punctuation">,</span> <span class="token comment">// 用于配置TextTheme、primaryTextTheme和accentTextTheme的颜色和几何TextTheme值。</span>
  CupertinoThemeData cupertinoOverrideTheme <span class="token comment">// 可以使用cupertinoOverrideTheme的属性来覆盖CupertinoThemeData各个属性的级联效果。</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre></div><h2 id="ongenerateroute"><a href="#ongenerateroute" class="header-anchor">#</a> onGenerateRoute</h2> <p>当应用程序导航到命名路由时使用的回调。</p> <h2 id="路由跳转"><a href="#路由跳转" class="header-anchor">#</a> 路由跳转</h2> <ul><li>pushNamedAndRemoveUntil 将命名路由推送到Navigator，删除所有路由栈内的路由，适用于启动页</li> <li>pushAndRemoveUntil 将给定路由推送到Navigator，删除先前的路由</li> <li>push 将设置的router信息推送到Navigator上，实现页面跳转</li> <li>of 主要是获取 Navigator最近实例的好状态</li> <li>pop 导航到新页面，或者返回到上个页面</li> <li>canPop 判断是否可以导航到新页面</li> <li>maybePop 可能会导航到新页面</li> <li>popAndPushNamed 指定一个路由路径，并导航到新页面</li> <li>popUntil 反复执行pop</li> <li>pushNamed 将命名路由推送到Navigator</li> <li>pushReplacement 路由替换</li> <li>pushReplacementNamed 这个也是替换路由操作。推送一个命名路由到Navigator，新路由完成动画之后处理上一个路由</li> <li>removeRoute 从Navigator中删除路由，同时执行Route.dispose操作</li> <li>removeRouteBelow 从Navigator中删除路由，同时执行Route.dispose操作，要替换的路由是传入参数anchorRouter里面的路由</li> <li>replace 将Navigator中的路由替换成一个新路由</li> <li>replaceRouteBelow 将Navigator中的路由替换成一个新路由，要替换的路由是是传入参数anchorRouter里面的路由</li></ul> <h2 id="事件监听"><a href="#事件监听" class="header-anchor">#</a> 事件监听</h2> <ol><li>指针事件 Pointer</li></ol> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token comment">// 原始事件监听</span>

<span class="token function">Listener</span><span class="token punctuation">(</span>
    onPointerDown<span class="token punctuation">:</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'指针按下：$event'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onPointerMove<span class="token punctuation">:</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'指针移动：$event'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onPointerUp<span class="token punctuation">:</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'指针松开：$event'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onPointerCancel<span class="token punctuation">:</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'指针打断取消：$event'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    child<span class="token punctuation">:</span> <span class="token function">Container</span><span class="token punctuation">(</span>
        width<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        height<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        color<span class="token punctuation">:</span> Colors<span class="token punctuation">.</span>lime<span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">)</span>

</code></pre></div><ol start="2"><li>手势识别Gesture</li></ol> <ul><li><p>onTapDown：用户发生手指按下的操作</p></li> <li><p>onTapUp：用户发生手指抬起的操作</p></li> <li><p>onTap：用户点击事件完成</p></li> <li><p>onTapCancel：事件按下过程中被取消</p></li> <li><p>onDoubleTap：双击</p></li> <li><p>onLongPress：长按</p></li> <li><p>onVerticalDragStart：指针和屏幕产生接触并可能开始纵向移动；</p></li> <li><p>onVerticalDragUpdate：指针和屏幕产生接触，在纵向上发生移动并保持移动；</p></li> <li><p>onVerticalDragEnd：指针和屏幕产生接触结束；</p></li> <li><p>onHorizontalDragStart：指针和屏幕产生接触并可能开始横向移动；</p></li> <li><p>onHorizontalDragUpdate：指针和屏幕产生接触，在横向上发生移动并保持移动；</p></li> <li><p>onHorizontalDragEnd：指针和屏幕产生接触结束；</p></li> <li><p>onPanStart：指针和屏幕产生接触并可能开始横向移动或者纵向移动。如果设置了 onHorizontalDragStart 或者 onVerticalDragStart，该回调方法会引发崩溃；</p></li> <li><p>onPanUpdate：指针和屏幕产生接触，在横向或者纵向上发生移动并保持移动。如果设置了 onHorizontalDragUpdate 或者 onVerticalDragUpdate，该回调方法会引发崩溃。</p></li> <li><p>onPanEnd：指针先前和屏幕产生了接触，并且以特定速度移动，此后不再在屏幕接触上发生移动。如果设置了 onHorizontalDragEnd 或者 onVerticalDragEnd，该回调方法会引发崩溃。</p></li></ul> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token function">GestureDetector</span><span class="token punctuation">(</span>
    onTapDown<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'手指按下'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onTapUp<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'手指抬起'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onTapCancel<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'手势取消'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onTap<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'手指点击'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onDoubleTap<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'手指双击'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    onLongPress<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">'手指长按'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    child<span class="token punctuation">:</span> <span class="token function">Container</span><span class="token punctuation">(</span>
        width<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        height<span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span>
        color<span class="token punctuation">:</span> Colors<span class="token punctuation">.</span>lime<span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span>

</code></pre></div><h2 id="flutter之动画"><a href="#flutter之动画" class="header-anchor">#</a> flutter之动画</h2> <h3 id="全自动动画-animation"><a href="#全自动动画-animation" class="header-anchor">#</a> 全自动动画 (Animation)</h3> <h3 id="手动控制-transform"><a href="#手动控制-transform" class="header-anchor">#</a> 手动控制 (Transform)</h3> <p>手动控制动画我们需要在<code>initState</code>里面初始化需要的<code>AnimationController</code>，这个函数提供<code>AnimationDouble</code>给动画插入过渡帧，它的常用参数：</p> <ul><li><p>vsync 必传参数不同机型上使用不同的垂直同步帧数，传this即可，不过你必须在state类上用with混入SingleTickerProviderStateMixin才可以使用this</p></li> <li><p>upperBound 动画起始值</p></li> <li><p>lowerBound 动画结束值</p></li> <li><p>duration 控制动画时长</p></li></ul> <p><em>upperBound和lowerBound也就是动画的取值范围，默认是0-1</em></p> <p>使用timeDilation让动画慢速执行方便看效果：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token keyword">import</span> <span class="token string">'package:flutter/scheduler.dart'</span> <span class="token keyword">show</span> timeDilation<span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">HeroAnimation</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">{</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    timeDilation <span class="token operator">=</span> <span class="token number">5.0</span><span class="token punctuation">;</span> <span class="token comment">// 1.0表示正常的动画速度。</span>

    <span class="token keyword">return</span> <span class="token function">Scaffold</span><span class="token punctuation">(</span>
      appBar<span class="token punctuation">:</span> <span class="token function">AppBar</span><span class="token punctuation">(</span>
        title<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'Basic Hero Animation'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token function">Center</span><span class="token punctuation">(</span>
        child<span class="token punctuation">:</span> <span class="token function">PhotoHero</span><span class="token punctuation">(</span>
          photo<span class="token punctuation">:</span> <span class="token string">'images/flippers-alpha.png'</span><span class="token punctuation">,</span>
          width<span class="token punctuation">:</span> <span class="token number">300.0</span><span class="token punctuation">,</span>
          onTap<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Navigator<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>MaterialPageRoute<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">&gt;</span><span class="token punctuation">(</span>
              builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token function">Scaffold</span><span class="token punctuation">(</span>
                  appBar<span class="token punctuation">:</span> <span class="token function">AppBar</span><span class="token punctuation">(</span>
                    title<span class="token punctuation">:</span> <span class="token keyword">const</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'Flippers Page'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">)</span><span class="token punctuation">,</span>
                  body<span class="token punctuation">:</span> <span class="token function">Container</span><span class="token punctuation">(</span>
                    <span class="token comment">// 蓝色背景强调这是一条新路线。</span>
                    color<span class="token punctuation">:</span> Colors<span class="token punctuation">.</span>lightBlueAccent<span class="token punctuation">,</span>
                    padding<span class="token punctuation">:</span> <span class="token keyword">const</span> EdgeInsets<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token number">16.0</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    alignment<span class="token punctuation">:</span> Alignment<span class="token punctuation">.</span>topLeft<span class="token punctuation">,</span>
                    child<span class="token punctuation">:</span> <span class="token function">PhotoHero</span><span class="token punctuation">(</span>
                      photo<span class="token punctuation">:</span> <span class="token string">'images/flippers-alpha.png'</span><span class="token punctuation">,</span>
                      width<span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">,</span>
                      onTap<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        Navigator<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">pop</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                      <span class="token punctuation">}</span><span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span>
            <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="自定义动画animatedbuilder"><a href="#自定义动画animatedbuilder" class="header-anchor">#</a> 自定义动画AnimatedBuilder</h3> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token keyword">class</span> <span class="token class-name">AnimationRoute</span> <span class="token keyword">extends</span> <span class="token class-name">StatefulWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata symbol">@override</span>
  AnimationRouteState <span class="token function">createState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">AnimationRouteState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
 
<span class="token keyword">class</span> <span class="token class-name">AnimationRouteState</span> <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token operator">&lt;</span>AnimationRoute<span class="token operator">&gt;</span> <span class="token keyword">with</span> SingleTickerProviderStateMixin <span class="token punctuation">{</span>
 
  Animation<span class="token operator">&lt;</span>double<span class="token operator">&gt;</span> animation<span class="token punctuation">;</span>
  AnimationController controller<span class="token punctuation">;</span>
 
  <span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">initState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    _controller <span class="token operator">=</span> <span class="token function">AnimationController</span><span class="token punctuation">(</span>
        duration<span class="token punctuation">:</span> <span class="token function">Duration</span><span class="token punctuation">(</span>seconds<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        vsync<span class="token punctuation">:</span> <span class="token keyword">this</span> <span class="token comment">//</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// Tween设置动画的区间值，animate()方法传入一个Animation，AnimationController继承Animation</span>
    animation <span class="token operator">=</span> <span class="token function">Tween</span><span class="token punctuation">(</span>begin<span class="token punctuation">:</span> <span class="token number">100.0</span><span class="token punctuation">,</span> end<span class="token punctuation">:</span> <span class="token number">200.0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">animate</span><span class="token punctuation">(</span>_controller<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//启动动画</span>
    _controller<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
  <span class="token metadata symbol">@override</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">AnimatedBuilder</span><span class="token punctuation">(</span>
        animation<span class="token punctuation">:</span> animation<span class="token punctuation">,</span>
        <span class="token comment">// 这个builder方法每次绘图都会执行</span>
        builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>BuildContext context<span class="token punctuation">,</span> Widget child<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">return</span> <span class="token function">Center</span><span class="token punctuation">(</span>
            child<span class="token punctuation">:</span> <span class="token function">Container</span><span class="token punctuation">(</span>
              color<span class="token punctuation">:</span> Colors<span class="token punctuation">.</span>black<span class="token punctuation">,</span>
              alignment<span class="token punctuation">:</span> Alignment<span class="token punctuation">.</span>center<span class="token punctuation">,</span>
              width<span class="token punctuation">:</span> animation<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
              height<span class="token punctuation">:</span> animation<span class="token punctuation">.</span>value<span class="token punctuation">,</span>
              child<span class="token punctuation">:</span> child <span class="token comment">// 没有变化的Widget使用child属性优化性能</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        child<span class="token punctuation">:</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">'jscodev'</span><span class="token punctuation">,</span>
            style<span class="token punctuation">:</span> <span class="token function">TextStyle</span><span class="token punctuation">(</span>
                color<span class="token punctuation">:</span> Colors<span class="token punctuation">.</span>black<span class="token punctuation">,</span>
                fontSize<span class="token punctuation">:</span> <span class="token number">18.0</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
 
  <span class="token metadata symbol">@override</span>
  <span class="token keyword">void</span> <span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 释放资源</span>
    _controller<span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">dispose</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><p>Hero主动画</p> <p>可以让两个页面产生关联动画</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token keyword">class</span> <span class="token class-name">HeroAnimationRoute</span> <span class="token keyword">extends</span> <span class="token class-name">StatelessWidget</span> <span class="token punctuation">{</span>
  <span class="token metadata symbol">@override</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Container</span><span class="token punctuation">(</span>
      alignment<span class="token punctuation">:</span> Alignment<span class="token punctuation">.</span>topCenter<span class="token punctuation">,</span>
      child<span class="token punctuation">:</span> <span class="token function">InkWell</span><span class="token punctuation">(</span>
        child<span class="token punctuation">:</span> <span class="token function">Hero</span><span class="token punctuation">(</span>
          tag<span class="token punctuation">:</span> <span class="token string">&quot;avatar&quot;</span><span class="token punctuation">,</span> <span class="token comment">//唯一标记，前后两个路由页Hero的tag必须相同</span>
          child<span class="token punctuation">:</span> <span class="token function">ClipOval</span><span class="token punctuation">(</span>
            child<span class="token punctuation">:</span> Image<span class="token punctuation">.</span><span class="token function">asset</span><span class="token punctuation">(</span><span class="token string">&quot;images/avatar.png&quot;</span><span class="token punctuation">,</span>
              width<span class="token punctuation">:</span> <span class="token number">50.0</span><span class="token punctuation">,</span>
            <span class="token punctuation">)</span><span class="token punctuation">,</span>
          <span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
        onTap<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">//打开B路由  </span>
          Navigator<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> <span class="token function">PageRouteBuilder</span><span class="token punctuation">(</span>
              pageBuilder<span class="token punctuation">:</span> <span class="token punctuation">(</span>BuildContext context<span class="token punctuation">,</span> Animation animation<span class="token punctuation">,</span>
                  Animation secondaryAnimation<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">FadeTransition</span><span class="token punctuation">(</span>
                  opacity<span class="token punctuation">:</span> animation<span class="token punctuation">,</span>
                  child<span class="token punctuation">:</span> <span class="token function">Scaffold</span><span class="token punctuation">(</span>
                    appBar<span class="token punctuation">:</span> <span class="token function">AppBar</span><span class="token punctuation">(</span>
                      title<span class="token punctuation">:</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">&quot;原图&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                    <span class="token punctuation">)</span><span class="token punctuation">,</span>
                    body<span class="token punctuation">:</span> <span class="token function">HeroAnimationRouteB</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
                  <span class="token punctuation">)</span><span class="token punctuation">,</span>
                <span class="token punctuation">)</span><span class="token punctuation">;</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre></div><h3 id="嵌入式插件动画rive-flare"><a href="#嵌入式插件动画rive-flare" class="header-anchor">#</a> 嵌入式插件动画Rive/Flare</h3> <p>有时候一些复杂的动画不管是使用flutter还是使用万能自定义动画AnimatedBuilder都是我们做不到或者说做起来很麻烦的
在<a href="https://pub.dev/" target="_blank" rel="noopener noreferrer">插件市场<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>找到<code>flare_flutter</code>安装最新版本，在项目的<code>pubspec.yaml</code>配置如下信息</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
dependencies<span class="token punctuation">:</span>
  flutter<span class="token punctuation">:</span>
    sdk<span class="token punctuation">:</span> flutter
  flare_flutter<span class="token punctuation">:</span> <span class="token operator">^</span><span class="token number">2.0</span><span class="token number">.6</span>  <span class="token comment">// 这里以你当时的最新版本为准，我这里最新的是2.0.6</span>

</code></pre></div><p>然后执行<code>flutter pub get</code>，一般flutter会帮你自动执行。</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token keyword">class</span> <span class="token class-name">_MyHomePageState</span> <span class="token keyword">extends</span> <span class="token class-name">State</span><span class="token operator">&lt;</span>MyHomePage<span class="token operator">&gt;</span> <span class="token punctuation">{</span>

  <span class="token comment">//  初始动画状态</span>
  String _animation <span class="token operator">=</span> <span class="token string">&quot;Idle&quot;</span><span class="token punctuation">;</span>

  <span class="token metadata symbol">@override</span>
  Widget <span class="token function">build</span><span class="token punctuation">(</span>BuildContext context<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">Scaffold</span><span class="token punctuation">(</span>
      appBar<span class="token punctuation">:</span> <span class="token function">AppBar</span><span class="token punctuation">(</span>
        title<span class="token punctuation">:</span> <span class="token function">Text</span><span class="token punctuation">(</span><span class="token string">&quot;动画&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      body<span class="token punctuation">:</span> <span class="token function">Center</span><span class="token punctuation">(</span>
        child<span class="token punctuation">:</span> <span class="token function">FlareActor</span><span class="token punctuation">(</span>
          <span class="token string">&quot;assets/anim/buttonAnim.flr&quot;</span><span class="token punctuation">,</span>
          alignment<span class="token punctuation">:</span> Alignment<span class="token punctuation">.</span>center<span class="token punctuation">,</span>
          fit<span class="token punctuation">:</span> BoxFit<span class="token punctuation">.</span>contain<span class="token punctuation">,</span>
          animation<span class="token punctuation">:</span> _animation<span class="token punctuation">,</span>
        <span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
      floatingActionButton<span class="token punctuation">:</span> <span class="token function">FloatingActionButton</span><span class="token punctuation">(</span>
        onPressed<span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token function">setState</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">//  执行到AnimButton状态</span>
            _animation <span class="token operator">=</span>  <span class="token string">&quot;AnimButton&quot;</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        child<span class="token punctuation">:</span> <span class="token function">Icon</span><span class="token punctuation">(</span>Icons<span class="token punctuation">.</span>play_arrow<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 上面例子里这段代码为主要代码引入动画</span>

<span class="token function">FlareActor</span><span class="token punctuation">(</span>
  <span class="token string">&quot;assets/anim/buttonAnim.flr&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 引入路径</span>
  alignment<span class="token punctuation">:</span> Alignment<span class="token punctuation">.</span>center<span class="token punctuation">,</span> <span class="token comment">// 对齐方式</span>
  fit<span class="token punctuation">:</span> BoxFit<span class="token punctuation">.</span>contain<span class="token punctuation">,</span>  <span class="token comment">// 自适应填充</span>
  animation<span class="token punctuation">:</span> _animation<span class="token punctuation">,</span> <span class="token comment">// 动画控制器</span>
<span class="token punctuation">)</span><span class="token punctuation">,</span>

</code></pre></div><p><a href="https://rive.app/" target="_blank" rel="noopener noreferrer">Rive<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>是制作导出动画的地方，在这里导出动画后在项目中使用<code>Flare</code>引入使用。</p> <h2 id="setstate不好使"><a href="#setstate不好使" class="header-anchor">#</a> setState不好使</h2> <p>偶然间遇到在StatefulWidget组件里面使用setState不好使，这时候我是一脸懵逼的，不过解决也是非常简单的：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>

<span class="token function">StatefulBuilder</span><span class="token punctuation">(</span>
    builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>BuildContext context<span class="token punctuation">,</span> <span class="token keyword">void</span> <span class="token keyword">Function</span><span class="token punctuation">(</span><span class="token keyword">void</span> <span class="token keyword">Function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> setState<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token function">ListView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre></div><p>原因是因为我们一开始可能使用的Widget默认是无状态组件，所以我们要在外层嵌套一个StatefulBuilder。</p> <h2 id="flutter中让盒子铺满屏幕"><a href="#flutter中让盒子铺满屏幕" class="header-anchor">#</a> flutter中让盒子铺满屏幕</h2> <p>有三种方式：</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token comment">// 获取当前设备的信息让元素宽度等于设备的宽度</span>

MediaQuery<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span><span class="token punctuation">.</span>size<span class="token punctuation">.</span>width<span class="token punctuation">;</span>

<span class="token comment">// 无限大的数值，总会大出屏幕，flutter处理成设备宽高</span>

width<span class="token punctuation">:</span> double<span class="token punctuation">.</span>infinity

<span class="token comment">// 无限大的数值，总会大出屏幕，flutter处理成设备宽高</span>

BoxConstraints<span class="token punctuation">.</span><span class="token function">expand</span><span class="token punctuation">(</span><span class="token punctuation">)</span>



</code></pre></div><p>MediaQuery的参数如下：</p> <ul><li><p>size 	逻辑像素，并不是物理像素，类似于Android中的dp，逻辑像素会在不同大小的手机上显示的大小基本一样，物理像素 = size*devicePixelRatio。</p></li> <li><p>devicePixelRatio 	单位逻辑像素的物理像素数量，即设备像素比。</p></li> <li><p>textScaleFactor 	单位逻辑像素字体像素数，如果设置为1.5则比指定的字体大50%。</p></li> <li><p>platformBrightness 	当前设备的亮度模式，比如在Android Pie手机上进入省电模式，所有的App将会使用深色（dark）模式绘制。</p></li> <li><p>viewInsets 	被系统遮挡的部分，通常指键盘，弹出键盘，viewInsets.bottom表示键盘的高度。</p></li> <li><p>padding 	被系统遮挡的部分，通常指“刘海屏”或者系统状态栏。</p></li> <li><p>viewPadding 	被系统遮挡的部分，通常指“刘海屏”或者系统状态栏，此值独立于padding和viewInsets，它们的值从MediaQuery控件边界的边缘开始测量。在移动设备上，通常是全屏。</p></li> <li><p>systemGestureInsets 	显示屏边缘上系统“消耗”的区域输入事件，并阻止将这些事件传递给应用。比如在Android Q手势滑动用于页面导航（ios也一样），比如左滑退出当前页面。</p></li> <li><p>physicalDepth 	设备的最大深度，类似于三维空间的Z轴。</p></li> <li><p>alwaysUse24HourFormat 	是否是24小时制。</p></li> <li><p>accessibleNavigation 	用户是否使用诸如TalkBack或VoiceOver之类的辅助功能与应用程序进行交互，用于帮助视力有障碍的人进行使用。</p></li> <li><p>invertColors 	是否支持颜色反转。</p></li> <li><p>highContrast 	用户是否要求前景与背景之间的对比度高， iOS上，方法是通过“设置”-&gt;“辅助功能”-&gt;“增加对比度”。 此标志仅在运行iOS 13的iOS设备上更新或以上。</p></li> <li><p>disableAnimations 	平台是否要求尽可能禁用或减少动画。</p></li> <li><p>boldText 	平台是否要求使用粗体。</p></li> <li><p>orientation 	是横屏还是竖屏。</p></li></ul> <h2 id="listview"><a href="#listview" class="header-anchor">#</a> ListView</h2> <p>我们知道<code>flutter</code>布局超出屏幕是会报错的，所以<code>ListView</code>是创建一个可滚动的盒子，还可以扩展为<code>ListView</code>.builder来控制更细粒的操作。
当我们使用一个确定不需要滚动的页面时，考虑用户不同机型可能会出现屏幕过短，所以应该在外层套入<code>SingleChildScrollView</code>，这样就只有屏幕过短的时候才会出现滚动效果，不过除了特定场景下不要频繁使用<code>SingleChildScrollView</code>会造成性能缺失。</p> <h2 id="gridview"><a href="#gridview" class="header-anchor">#</a> GridView</h2> <div class="language-dart extra-class"><pre class="language-dart"><code>
GridView<span class="token punctuation">.</span><span class="token function">count</span><span class="token punctuation">(</span>
  shrinkWrap<span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 属性让盒子只占据组件大小而不占据屏幕大小</span>
  childAspectRatio<span class="token punctuation">:</span> <span class="token number">2</span> <span class="token operator">/</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 控制元素比例</span>
  physics<span class="token punctuation">:</span> <span class="token function">NeverScrollableScrollPhysics</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 让元素无法滚动</span>
<span class="token punctuation">)</span>

</code></pre></div><h2 id="stream"><a href="#stream" class="header-anchor">#</a> Stream</h2> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token keyword">final</span> controller <span class="token operator">=</span> <span class="token function">StreamController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 创建监听器</span>

<span class="token function">StreamBuilder</span><span class="token punctuation">(</span>
  stream<span class="token punctuation">:</span> controller<span class="token punctuation">.</span>stream<span class="token punctuation">,</span> <span class="token comment">// 使用监听器</span>
  builder<span class="token punctuation">:</span> <span class="token punctuation">(</span>ctx<span class="token punctuation">,</span> snapshot<span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">)</span>

</code></pre></div><h2 id="flutter队列"><a href="#flutter队列" class="header-anchor">#</a> flutter队列</h2> <p>在<code>flutter</code>里面<code>main</code>函数作为入口，当<code>main</code>执行完后会进行事件循环，检查<code>Microtask</code>和<code>Event</code>里面有没有需要执行的事件（<code>Microtask</code>优先于<code>Event</code>）；一般使用单线程就足够应对大多数场景，如果遇到线程堵塞需要等待的时候我们也可以使用<code>IsoLate</code>创建多线程解决。</p> <div class="language-dart extra-class"><pre class="language-dart"><code>
<span class="token comment">// 直接运行</span>

Future<span class="token punctuation">.</span><span class="token keyword">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Future<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// Microtask</span>

<span class="token function">scheduleMicrotask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
Future<span class="token punctuation">.</span><span class="token function">microtask</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Future<span class="token punctuation">.</span><span class="token function">value</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 加上.then后会被加到Microtask</span>

<span class="token comment">// Event</span>

<span class="token function">Future</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 直接推送到Event上</span>
Future<span class="token punctuation">.</span><span class="token function">delayed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 延时推送到Event上</span>

Future<span class="token punctuation">.</span><span class="token function">delayed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>value<span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token function">print</span><span class="token punctuation">(</span><span class="token string">&quot;value&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 会在执行完Future之后立即执行，不会被加入到Microtask和Event</span>

</code></pre></div><div></div></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.f47b2c40.js" defer></script><script src="/assets/js/2.af72bc87.js" defer></script><script src="/assets/js/14.64749a17.js" defer></script><script src="/assets/js/7.2e35d67b.js" defer></script>
  </body>
</html>
